<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <!--handles checking the search filter-->
    <div id="txtEntry">
        <input id="txtBox" type="text" />
    </div>

    <div>
        <button id="submit" onclick="sanitiseSearch(document.getElementById('txtBox').value)">submit</button>
    </div>

    <div>
        <p id="searchOutput">output: </p>
    </div>
    <!--End search filter testing-->
    <br />
    <br />

    <!--handles checking the web storage filter-->
    <div>
        <button id="instance" onclick="instanceStorage()">Instance web storage</button>
    </div>

    <div id="storageEntry">
        <input id="storageInput" type="text" />
    </div>

    <div>
        <button id="storageSubmit" onclick="sanitiseWebStorage(document.getElementById('storageInput').value)">enter</button>
    </div>

    <div>
        <p id="storageOutput">output: </p>
    </div>
    <!--End web storage filter test-->

    <!--The actual sanitisation code-->
    <script>
        function sanitiseSearch(inTxt) {
            //do sanitisation
            var outTxt, maxLen;
            maxLen = 12;

            //regex to remove all non alphanumeric or whitespace characters
            outTxt = inTxt.replace(/[^0-9a-zA-Z ]/g, "");

            //only accept strings less than maxLen characters
            if (outTxt.length > maxLen) {
                outTxt = outTxt.slice(0, maxLen);
            }

            //Add new rules here

            document.getElementById("searchOutput").innerHTML = "output: " + outTxt;
            //return outTxt;    temporarily remove until ready to automate test
        }

        function sanitiseWebStorage(inKey) {
            var inRef, outRef, maxLen;
            maxLen = 12;

            inRef = localStorage.getItem(inKey);

            //regex to remove all non alphanumeric characters
            outRef = inRef.replace(/[^0-9a-zA-Z]/g, "");

            //only accept up to maxLen characters
            if (outTxt.length > maxLen) {
                outTxt = outTxt.slice(0, maxLen);
            }

            //Add new rules here

            document.getElementById("storageOutput").innerHTML = "output: " + outRef;
            //return outRef;
        }

        function instanceStorage() {
            //add some entries into html web storage
            localStorage.setItem("Video 1", "/videos/Video1");
            localStorage.setItem("Video 2", "/videos/Video2");
            localStorage.setItem("Text 1", "/text/Text1");
            localStorage.setItem("Disallowed", "<script>something malicious<//script>");
        }
    </script>
</body>
</html>